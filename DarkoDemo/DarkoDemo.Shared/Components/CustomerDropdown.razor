@inject CustomerSwitcherService CustomerSwitcher
@inject CoreApiClient CoreApi

@if (customers is not null)
{
    <MudSelect T="Guid" @bind-Value="CustomerSwitcher.CurrentCustomerId" FitContent="true">
        @foreach (var c in customers)
        {
            <MudSelectItem Value="@c.Id">@c.Name</MudSelectItem>
        }
    </MudSelect>
}

@code {
    private IEnumerable<CustomerRead>? customers;

    protected override async Task OnInitializedAsync()
    {
        customers = await CoreApi.ReadCustomers();

        if (customers is not null && customers.Any() && CustomerSwitcher.CurrentCustomerId == Guid.Empty)
        {
            CustomerSwitcher.SetCustomer(customers.First().Id);
        }
    }
}
