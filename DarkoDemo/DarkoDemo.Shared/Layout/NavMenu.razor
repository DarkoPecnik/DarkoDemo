@inject CustomerSwitcherService CustomerSwitcher

<MudNavMenu>
    <MudNavLink Href="@Routes.Home" Match="NavLinkMatch.All">Dashboard</MudNavLink>
    <MudNavLink Href="@Routes.Store" Match="NavLinkMatch.Prefix">Store</MudNavLink>
    <MudNavLink Href="@Routes.GetBasketRoute(CustomerId)" Match="NavLinkMatch.Prefix">Basket</MudNavLink>
    <MudNavGroup Title="Administration" Expanded="true">
        <MudNavLink Href="@Routes.Admin.Customers" Match="NavLinkMatch.Prefix">Customers</MudNavLink>
        <MudNavLink Href="@Routes.Admin.Categories" Match="NavLinkMatch.Prefix">Categories</MudNavLink>
        <MudNavLink Href="@Routes.Admin.Products" Match="NavLinkMatch.Prefix">Products</MudNavLink>
    </MudNavGroup>
</MudNavMenu>

@code {
    private Guid CustomerId;

    protected override void OnInitialized()
    {
        CustomerId = CustomerSwitcher.CurrentCustomerId;
        CustomerSwitcher.CustomerChanged += OnCustomerChanged;
    }

    private void OnCustomerChanged(Guid id)
    {
        CustomerId = id;
        StateHasChanged();
    }

    public void Dispose()
    {
        CustomerSwitcher.CustomerChanged -= OnCustomerChanged;
    }
}
