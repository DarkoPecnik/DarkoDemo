@inject CustomerSwitcherService CustomerSwitcher

<MudNavMenu>
    <MudNavLink Href="/" Match="NavLinkMatch.All">Dashboard</MudNavLink>
    <MudNavLink Href="/store" Match="NavLinkMatch.Prefix">Store</MudNavLink>
    <MudNavLink Href="@($"basket/{CustomerId}")" Match="NavLinkMatch.Prefix">Basket</MudNavLink>
    <MudNavGroup Title="Administration" Expanded="true">
        <MudNavLink Href="/customers" Match="NavLinkMatch.Prefix">Customers</MudNavLink>
        <MudNavLink Href="/categories" Match="NavLinkMatch.Prefix">Categories</MudNavLink>
        <MudNavLink Href="/products" Match="NavLinkMatch.Prefix">Products</MudNavLink>
    </MudNavGroup>
</MudNavMenu>

@code {
    private Guid CustomerId;

    protected override void OnInitialized()
    {
        CustomerId = CustomerSwitcher.CurrentCustomerId;
        CustomerSwitcher.CustomerChanged += OnCustomerChanged;
    }

    private void OnCustomerChanged(Guid id)
    {
        CustomerId = id;
        StateHasChanged();
    }

    public void Dispose()
    {
        CustomerSwitcher.CustomerChanged -= OnCustomerChanged;
    }
}
